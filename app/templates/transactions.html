<div id="transaction_history">
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th><span translate>th.from</span> <i class='fa fa-long-arrow-right'></i> <span translate>th.to</span></th>
        <th translate>th.memo</th>
        <th translate>th.amount</th>
        <th translate>th.fee</th>
        <th translate ng-show="showBalances">th.balance</th>
        <th translate>th.date</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="t in account_transactions | reverse | limitTo: 20" ng-if="!pending_only || ((!t.is_confirmed)&&(!t.is_virtual))">
        <td>
            <span ng-repeat="entry in t.ledger_entries" class='lead'>
                <!--From-->
                <span ng-if="entry.from.charAt(0) !== 'X'">
                    <span ng-if="entry.from[0] !== entry.from[0].toUpperCase()">
                        <img ng-src="http://robohash.org/set_any/{{entry.from}}?size=40x40" height="40" width="40"/>
                        <a href="#/accounts/{{entry.from}}">{{ entry.from }}</a>
                    </span>
                    <span ng-if="entry.from[0] === entry.from[0].toUpperCase()">
                        {{ entry.from }}
                    </span>
                </span>
                <span ng-if="entry.from.charAt(0) === 'X'">
                    <img ng-src="img/user.png" height="40" width="40"/>
                    <a class="text-danger" tooltip-placement="right" tooltip='Add {{ entry.from }} as a contact' href="#/newcontact?name=&key={{entry.from}}">{{ entry.from.substring(0, 11) }}...</a>
                </span>

                <i class='fa fa-long-arrow-right fa-lg'></i>

                <!--To-->
                <span ng-if='entry.from == entry.to'>
                    <a href="#/accounts/{{entry.to}}">self</a>
                </span>
                <span ng-if='entry.from != entry.to'>
                    <span ng-if="entry.to[0] !== entry.to[0].toUpperCase()">
                        <img src="http://robohash.org/set_any/{{entry.to}}?size=40x40" height="40" width="40"/>
                        <span>
                            <a href="#/accounts/{{entry.to}}" ng-if="entry.to[0] != entry.to[0].toUpperCase()">{{ entry.to }}</a>
                            <span ng-if="entry.to[0] == entry.to[0].toUpperCase()">{{ entry.from }}</span>
                        </span>
                    </span>
                    <span ng-if="entry.to[0] === entry.to[0].toUpperCase()">
                        {{ entry.to }}
                    </span>
                </span>
                <br>
            </span>
        </td>
        <td>
            <span ng-repeat="entry in t.ledger_entries">
                <span class="long-shorten-text-l">{{ entry.memo }}</span> <br>
            </span>
        </td>
        <td>
            <span ng-repeat="entry in t.ledger_entries">
                <span ng-if="entry.amount!=0">
                    <span ng-show="entry.from == account.name  && entry.to == account.name" class="bold text-primary"><i class="fa fa-undo"></i> {{ entry.amount_asset | formatAsset }}</span>
                    <span ng-show="entry.from == account.name && entry.to != account.name" class="bold text-danger">- {{ entry.amount_asset | formatAsset }}</span>
                    <span ng-show="entry.from != account.name" class="bold text-success">+ {{ entry.amount_asset | formatAsset }}</span>
                </span>
                <span ng-if="entry.amount==0" class="bold text-primary">{{ entry.amount_asset | formatAsset }}</span> <br>
            </span>
        </td>
        <td>{{ t.fee | formatAsset}}</td>
        <td>
            <span ng-repeat="entry in t.ledger_entries">
                <span ng-show="showBalances" ng-repeat="balance in entry.running_balances">
                    <span class="bold">{{ balance | formatAsset}}</span> <br>
                </span>
            </span>
        </td>
         <td>
            <a ng-if="t.is_confirmed" href="#/tx/{{t.id}}"><span tooltip="{{ t.time | prettyDate }}">{{ t.time | prettyRecentDate }}</span></a>
            <span ng-if="(!t.is_confirmed)&&(!t.is_virtual)">Pending</span>
        </td>
      </tr>
      <tr ng-if="warning">
        <td>{{warning}}</td>
        <td colspan="6"></td>
      </tr>
    </tbody>
  </table>
</div>
</div>
